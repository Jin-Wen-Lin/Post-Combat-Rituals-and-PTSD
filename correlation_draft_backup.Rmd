---
title: "Data Cleaning"
date: "2024-10-21"
output: pdf_document
---

```{r setup, include=FALSE}
library(readxl)
library(knitr)  
library(kableExtra)
library(tidyverse)
library(stringr)
library(tidyverse)
```


```{r}
# Load Data
rituals <- read_excel("Copy of Coded data from postcombat rituals July 18.xlsx")
glimpse(rituals)
rituals<- rituals %>% filter(str_detect())
```

```{r}
# delete the second column (duplicated)
rituals <- subset(rituals, select = -`What is the name of the culture...2`)
# change the cloumn name of What is the name of the culture
names(rituals)[names(rituals) == 'What is the name of the culture...4'] <- 'What is the name of the culture'

```


# First Question

```{r}
# Subset the first 63 rows of the 'rituals' dataset
rituals_subset <- rituals[1:63, ]

# Create a contingency table using the subset of the dataset
table_result <- table(rituals_subset$`Based on your reading of the text, would you consider the ritual rite of passage?`, 
                      rituals_subset$`Does the Ritual appear to involve a Purification/Cleansing of the participant?`)

# Convert the table to a data frame for easier plotting
df_table <- as.data.frame(table_result)

# Rename columns for easier reference
colnames(df_table) <- c("Ritual_Rite_of_Passage", "Purification_Cleansing", "Count")

# Combine the two columns into one label (e.g., "Yes to Yes", "Yes to No")
df_table$Combination <- paste(df_table$Ritual_Rite_of_Passage, "to", df_table$Purification_Cleansing)

# Load ggplot2 for creating the bar graph
library(ggplot2)

# Create the bar plot
ggplot(df_table, aes(x = Combination, y = Count, fill = Combination)) +
  geom_bar(stat = "identity") +  # Use stat = "identity" because we already have counts
  labs(x = "Yes/No Combinations", y = "Count", title = "Counts of Yes/No Combinations (First 63 Rows)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = "none")  # Remove the legend since we already have the labels on the x-axis
```







# Second Question (correlation test) 

Use Chi-square test for checking the correlation between variables since the variables are binary or categorical.  

```{r}
# Column X and T
chisq.test(x = rituals$`Does the Ritual also include a Cultural Incentive (Reward)`, 
           y = rituals$`Does the Ritual appear to involve a Purification/Cleansing of the participant?`)
```

```{r}
# Column T and AF
chisq.test(x = rituals$`Does the Ritual appear to involve a Purification/Cleansing of the participant?`, 
           y = rituals$`Based on the reading and your understanding, does this appear to be a purification ritual?`)
```

```{r}
# Column X and AF
chisq.test(x = rituals$`Does the Ritual also include a Cultural Incentive (Reward)`,
           y = rituals$`Based on the reading and your understanding, does this appear to be a purification ritual?`)
```

Warning exists for the three correlation tests might due tto the reason of samll dataset. By looking the results above, we can see that the p-values for each test are very close to 0. Notice that for chisquare test, the null hypothesis is to assume there is no association between variables. Since the p-values are way smaller than 0.05, then we failed to reject the null hypothesis. Therefore, these three variables are not independent.  

```{r}

```

